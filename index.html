<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fashionhabits — Streetwear & Chic</title>
  <meta name="description" content="Fashionhabits : boutique streetwear & chic. Veste polaire unisexe, livraisons rapides.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0a0a0b; --panel:#121214; --text:#f3f4f6; --muted:#a3a3a3;
      --accent-start:#7c3aed; --accent-end:#22d3ee;
      --success:#10b981; --danger:#ef4444;
      --shadow:0 10px 30px rgba(0,0,0,.35); --radius:18px;
      --chip:rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;line-height:1.55}
    a{color:inherit;text-decoration:none}
    img{display:block;max-width:100%}

    /* Header */
    .header{position:sticky;top:0;z-index:50;background:rgba(10,10,11,.6);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.06)}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}
    .nav{display:flex;align-items:center;justify-content:space-between;height:68px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));box-shadow:var(--shadow)}
    .brand h1{font-size:1.25rem;margin:0;font-weight:800;letter-spacing:.5px}
    .menu a{margin:0 12px;color:var(--muted)}
    .menu a.active,.menu a:hover{color:var(--text)}
    .cart-btn{display:flex;align-items:center;gap:10px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));border:none;color:white;padding:10px 14px;border-radius:14px;cursor:pointer;font-weight:700;box-shadow:var(--shadow)}

    /* Sections */
    section{padding:56px 0;border-top:1px solid rgba(255,255,255,.06)}
    h2.section-title{font-size:clamp(24px,4vw,36px);margin:0 0 18px 0}
    p.section-sub{color:var(--muted);margin:0 0 24px 0}

    /* ===== HERO ===== */
    .hero{position:relative;overflow:hidden}
    .hero .wrap{display:grid;grid-template-columns:1.1fr .9fr;gap:30px;align-items:center;padding:64px 0}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;background:rgba(255,255,255,.06);color:var(--muted);border:1px solid rgba(255,255,255,.08)}
    .title{font-size:clamp(32px,6vw,56px);line-height:1.05;margin:14px 0;font-weight:800}
    .subtitle{color:var(--muted);max-width:60ch}
    .cta{margin-top:20px;display:flex;gap:12px}
    .btn{display:inline-block;padding:12px 18px;border-radius:14px;font-weight:700;border:1px solid rgba(255,255,255,.12)}
    .btn-primary{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));border:none;color:white;box-shadow:var(--shadow)}
    .btn-ghost{color:var(--text)}

    /* Showcase moderne */
    .showcase{position:relative;border-radius:var(--radius);overflow:hidden;border:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));box-shadow:var(--shadow);min-height:520px;display:flex;align-items:center;justify-content:center;isolation:isolate}
    .showcase .blob{position:absolute;inset:-20% -10% auto auto;width:120%;height:140%;background:radial-gradient(600px 300px at 70% 10%, rgba(124,58,237,.35), transparent 60%), radial-gradient(500px 400px at 40% 80%, rgba(34,211,238,.28), transparent 60%);filter:blur(24px);z-index:0}
    .showcase-img{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;padding:34px;opacity:0;transition:opacity .7s ease}
    .showcase-img.active{opacity:1}
    .showcase .chips{position:absolute;inset:16px 16px auto 16px;display:flex;gap:10px;z-index:2;flex-wrap:wrap}
    .chip{padding:6px 10px;border-radius:999px;background:var(--chip);border:1px solid rgba(255,255,255,.18);color:#fff;font-size:.85rem}
    .showcase .dots{position:absolute;inset:auto 0 14px 0;display:flex;gap:10px;justify-content:center;z-index:2}
    .dot{width:10px;height:10px;border-radius:999px;border:1px solid rgba(255,255,255,.6);background:rgba(255,255,255,.15);cursor:pointer}
    .dot.active{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));border-color:transparent}

    /* Grid produits */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
    .card .media{position:relative}
    .card img.main{aspect-ratio:4/5;object-fit:cover;border-bottom:1px solid rgba(255,255,255,.06);cursor:zoom-in}
    .thumbs{display:flex;gap:8px;padding:10px;border-top:1px solid rgba(255,255,255,.06);overflow:auto}
    .thumbs img{width:56px;height:70px;object-fit:cover;border-radius:10px;border:2px solid transparent;opacity:.85;cursor:pointer;flex:0 0 auto}
    .thumbs img.active{border-color:var(--accent-end);opacity:1}
    .nav-arrows{position:absolute;inset:auto 0 0 0;display:flex;justify-content:space-between;padding:10px}
    .nav-arrows button{background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.2);color:#fff;border-radius:10px;padding:6px 10px;cursor:pointer}
    .card-body{padding:14px}
    .meta{display:flex;justify-content:space-between;align-items:center;margin-top:6px;color:var(--muted)}
    .price{font-weight:800}
    .variant{margin:10px 0;display:flex;gap:8px;flex-wrap:wrap}
    .pill{padding:6px 10px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);cursor:pointer;font-size:.9rem}
    .pill.active{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));color:white;border:none}
    .add-btn{margin-top:auto;display:block;width:100%;text-align:center;padding:12px;border:none;border-top:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.04);color:white;font-weight:700;cursor:pointer}
    .add-btn:hover{background:rgba(255,255,255,.08)}

    /* Drawer panier */
    .drawer{position:fixed;inset:0 0 0 auto;width:min(420px,100%);background:var(--panel);transform:translateX(110%);transition:transform .35s ease;box-shadow:var(--shadow);border-left:1px solid rgba(255,255,255,.08);z-index:100}
    .drawer.open{transform:none}
    .drawer header{display:flex;align-items:center;justify-content:space-between;padding:16px 16px;border-bottom:1px solid rgba(255,255,255,.08)}
    .drawer .items{max-height:60vh;overflow:auto;display:flex;flex-direction:column;gap:12px;padding:12px 16px}
    .item{display:grid;grid-template-columns:64px 1fr auto;gap:12px;align-items:center;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:8px}
    .qty{display:flex;align-items:center;gap:8px}
    .qty button{width:28px;height:28px;border-radius:8px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.06);color:white;cursor:pointer}
    .drawer footer{padding:16px;border-top:1px solid rgba(255,255,255,.08)}
    .summary{display:flex;justify-content:space-between;margin-bottom:12px}
    .checkout{width:100%;padding:12px 16px;border:none;border-radius:12px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));color:white;font-weight:800;cursor:pointer}
    .note{color:var(--muted);font-size:.9rem;margin-top:8px}
    .error{color:var(--danger);margin-top:8px}
    .success{color:var(--success);margin-top:8px}

    /* USP */
    .usp{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:20px}
    .usp .block{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);padding:16px;border-radius:16px}
    .muted{color:var(--muted)}

    /* Footer */
    footer{padding:30px 0;color:var(--muted)}
    .links{display:flex;gap:16px;flex-wrap:wrap}
    .links a{color:var(--muted)}
    .legal{opacity:.7;font-size:.9rem;margin-top:8px}

    /* ===== PAGE PRODUIT (PDP) ===== */
    .pdp{display:none}
    .pdp.show{display:block}
    .pdp .wrap{display:grid;grid-template-columns:1.05fr .95fr;gap:26px}
    .pdp-card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .pdp-gallery{padding:16px}
    .pdp-main{aspect-ratio:4/5;background:#0f1012;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .pdp-main img{max-width:100%;max-height:100%;object-fit:contain;cursor:zoom-in}
    .pdp-thumbs{display:flex;gap:10px;margin-top:12px;overflow:auto}
    .pdp-thumbs img{width:84px;height:100px;object-fit:cover;border-radius:10px;border:2px solid transparent;cursor:pointer;opacity:.85}
    .pdp-thumbs img.active{border-color:var(--accent-end);opacity:1}
    .pdp-info{padding:18px}
    .rating{display:flex;align-items:center;gap:10px}
    .stars{color:#facc15}
    .verified{padding:4px 8px;border-radius:999px;background:rgba(16,185,129,.15);border:1px solid rgba(16,185,129,.35);color:#a7f3d0;font-size:.8rem}
    .pdp-price{font-size:1.5rem;font-weight:800;margin:10px 0 6px}
    .pdp-cta{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .btn-xl{padding:12px 16px;border-radius:12px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.05);color:#fff;font-weight:700;cursor:pointer}
    .btn-buy{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));border:none}
    .backlink{display:inline-flex;align-items:center;gap:8px;color:var(--muted);margin-bottom:14px}
    .sep{height:1px;background:rgba(255,255,255,.08);margin:16px 0}

    /* Avis */
    .reviews{margin-top:18px}
    .reviews header{display:flex;justify-content:space-between;align-items:end;gap:12px;flex-wrap:wrap}
    .reviews h3{margin:0}
    .review{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px;margin-top:10px}
    .review .meta{display:flex;align-items:center;gap:10px;color:var(--muted);font-size:.9rem}
    .review .badge{padding:2px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06)}
    .review .stars{color:#facc15}
    .review-form{margin-top:14px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);padding:12px;border-radius:12px}
    .review-form input,.review-form textarea,.review-form select{width:100%;margin-top:8px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.15);background:#0f1012;color:#fff}
    .review-form button{margin-top:10px}

    /* Responsive */
    @media (max-width: 980px){
      .hero .wrap{grid-template-columns:1fr;gap:20px}
      .grid{grid-template-columns:repeat(2,1fr)}
      .usp{grid-template-columns:1fr}
      .showcase{min-height:440px}
      .pdp .wrap{grid-template-columns:1fr}
    }
    @media (max-width: 640px){
      .menu{display:none}
      .grid{grid-template-columns:1fr}
      .showcase{min-height:400px}
    }

    /* Reveal anim */
    .reveal{opacity:0;transform:translateY(12px);transition:opacity .6s ease, transform .6s ease}
    .reveal.show{opacity:1;transform:none}

    /* Lightbox */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:200}
    .lightbox.open{display:flex}
    .lb-panel{width:min(980px,96vw);background:#0f1012;border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:var(--shadow);padding:16px}
    .lb-main{aspect-ratio:4/5;max-height:70vh;background:#0b0c0e;border-radius:14px;overflow:hidden;display:flex;align-items:center;justify-content:center}
    .lb-main img{max-width:100%;max-height:100%;object-fit:contain}
    .lb-thumbs{display:flex;gap:10px;margin-top:12px;overflow:auto}
    .lb-thumbs img{width:84px;height:100px;object-fit:cover;border-radius:10px;border:2px solid transparent;cursor:pointer;opacity:.85}
    .lb-thumbs img.active{border-color:var(--accent-end);opacity:1}
    .lb-actions{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .lb-actions button{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
    .lb-close{background:transparent;border:none;color:#fff;font-size:22px;cursor:pointer}
  </style>
</head>
<body>
  <header class="header">
    <div class="container nav">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1>Fashionhabits</h1>
      </div>
      <nav class="menu">
        <a href="#home" class="active">Accueil</a>
        <a href="#shop">Boutique</a>
        <a href="#about">À propos</a>
        <a href="#contact">Contact</a>
      </nav>
      <button class="cart-btn" id="openCart" aria-label="Ouvrir le panier">🛒 <span id="cartCount">0</span></button>
    </div>
  </header>

  <!-- == HOME / HERO == -->
  <main id="home" class="hero">
    <div class="container wrap">
      <div>
        <span class="badge">Nouveauté • Streetwear & Chic</span>
        <h2 class="title">Affirme ton style.<br/>Épure, moderne, avec du caractère.</h2>
        <p class="subtitle">Sélection unisexe : coupes nettes, matières confort, détails premium. Livraison rapide en France & Europe.</p>
        <div class="cta">
          <a href="#shop" class="btn btn-primary">Voir la boutique</a>
          <a href="#about" class="btn ">En savoir plus</a>
        </div>
        <div class="usp">
          <div class="block reveal"><strong>Livraison </strong><div class="muted">France Métropolitaine</div></div>
          <div class="block reveal"><strong>Retours 14 jours</strong><div class="muted">Échange ou remboursement</div></div>
          <div class="block reveal"><strong>Paiement sécurisé</strong><div class="muted">Stripe • PayPal</div></div>
        </div>
      </div>

      <!-- Showcase moderne -->
      <aside class="showcase reveal" aria-label="Veste Polaire — galerie d'aperçu">
        <div class="blob" aria-hidden="true"></div>
        <div class="chips">
          <span class="chip">Nouvelle collection</span>
          <span class="chip">Chaud & confortable</span>
          <span class="chip">Unisexe</span>
        </div>
        <img class="showcase-img active" src="assets/veste-polaire-5.png" alt="Veste polaire — vue 1">
        <img class="showcase-img" src="assets/veste-polaire-1.png" alt="Veste polaire — vue 2">
        <img class="showcase-img" src="assets/veste-polaire-2.png" alt="Veste polaire — vue 3">
        <img class="showcase-img" src="assets/veste-polaire-3.png" alt="Veste polaire — vue 4">
        <img class="showcase-img" src="assets/veste-polaire-4.png" alt="Veste polaire — vue 5">
        <div class="dots" id="showcaseDots">
          <button class="dot active" data-i="0" aria-label="Visuel 1"></button>
          <button class="dot" data-i="1" aria-label="Visuel 2"></button>
          <button class="dot" data-i="2" aria-label="Visuel 3"></button>
          <button class="dot" data-i="3" aria-label="Visuel 4"></button>
          <button class="dot" data-i="4" aria-label="Visuel 5"></button>
        </div>
      </aside>
    </div>
  </main>

  <!-- == SHOP == -->
  <section id="shop">
    <div class="container">
      <h2 class="section-title">Boutique</h2>
      <p class="section-sub">Notre pièce phare pour démarrer.</p>
      <div class="grid" id="productGrid"></div>
    </div>
  </section>

  <!-- == PDP : page produit (SPA) == -->
  <section id="pdp" class="pdp">
    <div class="container">
      <a href="#shop" class="backlink">← Retour à la boutique</a>
      <div class="wrap">
        <!-- Col 1 : Galerie -->
        <div class="pdp-card pdp-gallery">
          <div class="pdp-main"><img id="pdpMain" alt="Veste polaire"></div>
          <div class="pdp-thumbs" id="pdpThumbs"></div>
        </div>
        <!-- Col 2 : Infos -->
        <div class="pdp-card pdp-info">
          <h2 id="pdpTitle" style="margin:0 0 8px 0">Veste Polaire</h2>
          <div class="rating">
            <div class="stars" id="pdpStars">★★★★★</div>
            <div><strong id="pdpNote">4.9/5</strong> <span class="muted">•</span> <span id="pdpCount">51 avis</span></div>
            <span class="verified">Achats vérifiés</span>
          </div>
          <div id="pdpDesc" class="muted" style="margin-top:8px">Veste polaire bicolore à col montant. Doublure chaude, poches pratiques, zip solide.</div>
          <div class="pdp-price" id="pdpPrice">39,99 €</div>
          <div class="muted">Tailles</div>
          <div class="variant" id="pdpSizes" style="margin-top:8px"></div>
          <div class="pdp-cta">
            <button class="btn-xl btn-buy" id="pdpAdd">Ajouter au panier</button>
            <button class="btn-xl" id="pdpBuyNow">Acheter maintenant</button>
          </div>

          <div class="sep"></div>

          <div class="reviews">
            <header>
              <h3>Avis clients</h3>
              <div class="muted" id="pdpSummary">Note moyenne 4.9/5 — 51 avis</div>
            </header>

            <div id="reviewsList"></div>

            <form id="reviewForm" class="review-form">
              <strong>Laisser un avis</strong>
              <div style="display:grid;grid-template-columns:1fr 140px;gap:10px;margin-top:8px">
                <input id="rvName" type="text" placeholder="Votre prénom" required>
                <select id="rvRating" required>
                  <option value="5">5 ★</option>
                  <option value="4">4 ★</option>
                  <option value="3">3 ★</option>
                  <option value="2">2 ★</option>
                  <option value="1">1 ★</option>
                </select>
              </div>
              <textarea id="rvText" rows="3" placeholder="Votre avis..." required></textarea>
              <button class="btn-xl btn-buy" type="submit">Publier (achat vérifié)</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- == About / Contact == -->
  <section id="about">
    <div class="container">
      <h2 class="section-title">À propos de Fashionhabits</h2>
      <p class="section-sub">Indépendants, nous créons des essentiels faciles à porter, au croisement du street et du chic. Qualité contrôlée, expédition rapide.</p>
    </div>
  </section>

  <section id="contact">
    <div class="container">
      <h2 class="section-title">Contact</h2>
      <p class="section-sub">Une question ? Écris-nous à <a href="mailto:hello@fashionhabits.fr">hello@fashionhabits.fr</a>.</p>
    </div>
  </section>

  <footer>
    <div class="container">
      <div class="links">
        <a href="#legal-mentions">Mentions légales</a> •
        <a href="#legal-privacy">Confidentialité</a> •
        <a href="#legal-returns">Retours & Remboursements</a>
      </div>
      <div class="legal">© <span id="year"></span> Fashionhabits. Tous droits réservés.</div>
    </div>
  </footer>

  <!-- Drawer Panier -->
  <aside class="drawer" id="drawer">
    <header>
      <strong>Panier</strong>
      <button id="closeCart" aria-label="Fermer">✕</button>
    </header>
    <div class="items" id="cartItems"></div>
    <footer>
      <div class="summary"><span>Total</span><strong id="cartTotal">0,00 €</strong></div>
      <button class="checkout" id="checkoutBtn">Payer maintenant</button>
      <div class="note">Paiement sécurisé via Stripe (à activer plus tard).</div>
      <div class="error" id="error"></div>
      <div class="success" id="success"></div>
    </footer>
  </aside>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-modal="true" role="dialog">
    <div class="lb-panel">
      <div class="lb-actions">
        <button class="lb-close" id="lbClose" aria-label="Fermer">✕</button>
        <div class="muted">Galerie produit</div>
        <div>
          <button id="lbPrev" aria-label="Précédent">◀</button>
          <button id="lbNext" aria-label="Suivant">▶</button>
        </div>
      </div>
      <div class="lb-main"><img id="lbMain" alt="Aperçu produit"></div>
      <div class="lb-thumbs" id="lbThumbs"></div>
    </div>
  </div>

  <script>
    /* ===== Données ===== */
    const PRODUCTS = [{
      id:"veste-polaire", title:"Veste Polaire", price:39.99, category:"Vêtements", gender:"Unisexe",
      sizes:["XS","S","M","L","XL"], image:"assets/veste-polaire-5.png",
      priceId:"price_xxx_VESTE_POLAIRE",
      description:"Veste polaire bicolore à col montant. Doublure chaude, poches pratiques, zip solide. Parfaite pour l’automne/hiver."
    }];

    const GALLERY = {
      "veste-polaire":[
        "assets/veste-polaire-5.png",
        "assets/veste-polaire-1.png",
        "assets/veste-polaire-2.png",
        "assets/veste-polaire-3.png",
        "assets/veste-polaire-4.png"
      ]
    };

    /* ===== Utils ===== */
    const formatPrice = n => new Intl.NumberFormat('fr-FR',{style:'currency',currency:'EUR'}).format(n);
    const el = html => { const t=document.createElement('template'); t.innerHTML=html.trim(); return t.content.firstElementChild; };
    const qs = (s,root=document)=>root.querySelector(s);
    const qsa = (s,root=document)=>Array.from(root.querySelectorAll(s));

    /* ===== Hero showcase (auto-fade) ===== */
    (function(){
      const imgs = qsa('.showcase-img');
      const dots = qsa('.dot');
      let i = 0, timer;
      const set = n => { i=n; imgs.forEach((im,k)=>im.classList.toggle('active',k===n)); dots.forEach((d,k)=>d.classList.toggle('active',k===n)); }
      const next = ()=> set((i+1)%imgs.length);
      const start=()=>{ stop(); timer=setInterval(next,4200); };
      const stop =()=> timer&&clearInterval(timer);
      dots.forEach(d=>d.addEventListener('click',()=>{ set(+d.dataset.i); start(); }));
      qs('.showcase')?.addEventListener('mouseenter',stop);
      qs('.showcase')?.addEventListener('mouseleave',start);
      set(0); start();
    })();

    /* ===== Render Boutique (1 seul produit) ===== */
    const grid = qs('#productGrid');
    (function renderShop(){
      const p = PRODUCTS[0];
      const thumbs = GALLERY[p.id].map((src,i)=>`<img src="${src}" data-index="${i}" class="${i===0?'active':''}" alt="miniature ${i+1}">`).join('');
      grid.appendChild(el(`
        <article class="card reveal" data-link="veste-polaire">
          <div class="media" data-id="${p.id}">
            <img src="${GALLERY[p.id][0]}" alt="${p.title}" class="main product-img" data-id="${p.id}">
            <div class="nav-arrows"><button class="prev" data-id="${p.id}">◀</button><button class="next" data-id="${p.id}">▶</button></div>
            <div class="thumbs" data-id="${p.id}">${thumbs}</div>
          </div>
          <div class="card-body">
            <h3 style="margin:0;font-size:1.05rem">${p.title}</h3>
            <div class="meta"><span class="muted">${p.category} • ${p.gender}</span><span class="price">${formatPrice(p.price)}</span></div>
            <div class="variant" data-id="${p.id}">${p.sizes.map(s=>`<button class="pill" data-size="${s}">${s}</button>`).join('')}</div>
            <div style="display:flex;gap:8px">
              <button class="add-btn" data-id="${p.id}">Ajouter au panier</button>
              <button class="add-btn" style="flex:0 0 auto;padding:12px 14px" data-openpdp="${p.id}">Détails</button>
            </div>
          </div>
        </article>
      `));
    })();

    /* Thumbs dans carte */
    document.addEventListener('click', e=>{
      const wrap = e.target.closest('.media'); if(!wrap) return;
      const id = wrap.dataset.id; const gal = GALLERY[id]; if(!gal) return;
      const main = qs('.main', wrap);
      if(e.target.matches('.prev,.next')){
        const cur = gal.findIndex(src => main.src.includes(src));
        const dir = e.target.classList.contains('prev') ? -1 : 1;
        const ni = (cur + dir + gal.length) % gal.length;
        main.src = gal[ni];
        qsa('.thumbs img', wrap).forEach((t,k)=>t.classList.toggle('active',k===ni));
      }
      if(e.target.matches('.thumbs img')){
        const idx = +e.target.dataset.index; main.src = gal[idx];
        qsa('.thumbs img', wrap).forEach((t,k)=>t.classList.toggle('active',k===idx));
      }
    });

    /* Sélection tailles */
    document.addEventListener('click', e=>{
      const pill = e.target.closest('.pill'); if(!pill) return;
      const v = pill.closest('.variant'); qsa('.pill', v).forEach(b=>b.classList.remove('active')); pill.classList.add('active');
    });

    /* ===== Panier ===== */
    const CART_KEY='fh_cart_v1';
    const loadCart=()=>JSON.parse(localStorage.getItem(CART_KEY)||'[]');
    const saveCart=c=>localStorage.setItem(CART_KEY,JSON.stringify(c));
    const cartCount=qs('#cartCount'), cartItems=qs('#cartItems'), cartTotal=qs('#cartTotal'), drawer=qs('#drawer');

    const updateBadge=()=>{ const c=loadCart(); cartCount.textContent=c.reduce((a,i)=>a+i.qty,0); };
    const renderCart=()=>{
      const c=loadCart(); cartItems.innerHTML=''; let total=0;
      c.forEach(it=>{
        const p=PRODUCTS.find(x=>x.id===it.id); if(!p) return;
        total += p.price*it.qty;
        cartItems.appendChild(el(`
          <div class="item">
            <img src="${GALLERY[p.id][0]}" alt="${p.title}">
            <div><div><strong>${p.title}</strong></div><div class="muted">Taille ${it.size}</div><div class="muted">${formatPrice(p.price)} × ${it.qty}</div></div>
            <div class="qty">
              <button data-action="dec" data-id="${it.id}" data-size="${it.size}">−</button>
              <span>${it.qty}</span>
              <button data-action="inc" data-id="${it.id}" data-size="${it.size}">+</button>
            </div>
          </div>`));
      });
      cartTotal.textContent=formatPrice(total); updateBadge();
    };

    document.addEventListener('click', e=>{
      if(e.target.matches('.add-btn[data-id]')){
        const id=e.target.dataset.id; const v=qs(`.variant[data-id="${id}"]`); const a=v?.querySelector('.pill.active');
        if(!a){ alert('Choisis une taille avant d’ajouter au panier.'); return; }
        const size=a.dataset.size; const cart=loadCart();
        const ex=cart.find(i=>i.id===id&&i.size===size); if(ex) ex.qty++; else cart.push({id,size,qty:1});
        saveCart(cart); renderCart(); drawer.classList.add('open'); return;
      }
      if(e.target.matches('#openCart')){ renderCart(); drawer.classList.add('open'); }
      if(e.target.matches('#closeCart')) drawer.classList.remove('open');
      if(e.target.closest('#cartItems button')){
        const b=e.target; const cart=loadCart();
        const idx=cart.findIndex(i=>i.id===b.dataset.id&&i.size===b.dataset.size); if(idx===-1) return;
        if(b.dataset.action==='inc') cart[idx].qty++; else { cart[idx].qty--; if(cart[idx].qty<=0) cart.splice(idx,1); }
        saveCart(cart); renderCart();
      }
    });
    updateBadge();

    const checkoutBtn = document.getElementById('checkoutBtn');
const errorEl = document.getElementById('error');

// Ton lien Stripe Payment Link
const PAYMENT_LINK = "https://buy.stripe.com/test_eVq28k1eq5GO2CieimdjO01"; // <--- remplace ici

checkoutBtn.addEventListener('click', () => {
  const cart = loadCart();
  if (cart.length === 0) {
    errorEl.textContent = 'Ton panier est vide.';
    return;
  }

  // Redirection directe vers Stripe
  window.location.href = PAYMENT_LINK;
});


    /* ===== Lightbox ===== */
    const lightbox=qs('#lightbox'), lbMain=qs('#lbMain'), lbThumbs=qs('#lbThumbs'), lbClose=qs('#lbClose');
    let lbImages=[], lbIndex=0;
    const renderLB=()=>{ lbMain.src=lbImages[lbIndex]; lbThumbs.innerHTML=''; lbImages.forEach((src,i)=>{const im=new Image();im.src=src; if(i===lbIndex) im.classList.add('active'); im.onclick=()=>{lbIndex=i;renderLB();}; lbThumbs.appendChild(im);}); };
    const openLB=(imgs,i=0)=>{ lbImages=imgs; lbIndex=i; renderLB(); lightbox.classList.add('open'); };
    const closeLB=()=>lightbox.classList.remove('open');
    lbClose.onclick=closeLB; lightbox.addEventListener('click',e=>{ if(e.target===lightbox) closeLB(); });
    qs('#lbPrev').onclick=()=>{ lbIndex=(lbIndex-1+lbImages.length)%lbImages.length; renderLB(); };
    qs('#lbNext').onclick=()=>{ lbIndex=(lbIndex+1)%lbImages.length; renderLB(); };
    document.addEventListener('keydown',e=>{ if(!lightbox.classList.contains('open')) return; if(e.key==='Escape') closeLB(); if(e.key==='ArrowLeft') qs('#lbPrev').click(); if(e.key==='ArrowRight') qs('#lbNext').click(); });

 // Ouvrir directement la fiche produit quand on clique sur l'image de la carte
document.addEventListener('click', e=>{
  const im = e.target.closest('.product-img');
  if(!im) return;
  // on route vers la PDP
  location.hash = '#p/veste-polaire';
});

    /* ===== PDP (page produit) ===== */
    const pdp=qs('#pdp'), home=qs('#home'), shop=qs('#shop'), about=qs('#about'), contact=qs('#contact');
    const pdpMain=qs('#pdpMain'), pdpThumbs=qs('#pdpThumbs'), pdpSizes=qs('#pdpSizes');
    const pdpAdd=qs('#pdpAdd'), pdpBuyNow=qs('#pdpBuyNow');

    function showPDP(id){
      const p=PRODUCTS.find(x=>x.id===id); if(!p) return;
      // Remplir infos
      qs('#pdpTitle').textContent=p.title;
      qs('#pdpDesc').textContent=p.description;
      qs('#pdpPrice').textContent=formatPrice(p.price);
      // Galerie
      const gal=GALLERY[id]; pdpMain.src=gal[0]; pdpThumbs.innerHTML = gal.map((src,i)=>`<img src="${src}" data-i="${i}" class="${i===0?'active':''}">`).join('');
      // Tailles
      pdpSizes.innerHTML = p.sizes.map(s=>`<button class="pill" data-size="${s}">${s}</button>`).join('');
      // Affichage
      home.style.display='none'; shop.style.display='none'; about.style.display='none'; contact.style.display='none';
      pdp.classList.add('show'); window.scrollTo(0,0);
      renderReviews(); // avis
    }

    function hidePDP(){
      pdp.classList.remove('show'); home.style.display=''; shop.style.display=''; about.style.display=''; contact.style.display='';
    }

    // router
    function route(){
      const h=location.hash;
      if(h.startsWith('#p/')) showPDP('veste-polaire'); else hidePDP();
    }
    window.addEventListener('hashchange',route); route();

    // interactions PDP
    pdpThumbs.addEventListener('click',e=>{
      const img=e.target.closest('img'); if(!img) return;
      const i=+img.dataset.i; const gal=GALLERY['veste-polaire']; pdpMain.src=gal[i];
      qsa('img',pdpThumbs).forEach((t,k)=>t.classList.toggle('active',k===i));
    });
    pdpMain.addEventListener('click',()=>openLB(GALLERY['veste-polaire'], GALLERY['veste-polaire'].findIndex(s=>pdpMain.src.includes(s))));

    pdpAdd.addEventListener('click',()=>{
      const id='veste-polaire'; const a=pdpSizes.querySelector('.pill.active'); if(!a){alert('Choisis une taille.');return;}
      const size=a.dataset.size; const cart=loadCart(); const ex=cart.find(i=>i.id===id&&i.size===size); if(ex) ex.qty++; else cart.push({id,size,qty:1});
      saveCart(cart); renderCart(); drawer.classList.add('open');
    });
    pdpBuyNow.addEventListener('click',()=>{ pdpAdd.click(); });

    pdpSizes.addEventListener('click',e=>{
      const pill=e.target.closest('.pill'); if(!pill) return;
      qsa('.pill',pdpSizes).forEach(b=>b.classList.remove('active')); pill.classList.add('active');
    });

    // ouvrir PDP depuis la carte
    document.addEventListener('click',e=>{
      if(e.target.matches('[data-openpdp]')){ location.hash='#p/veste-polaire'; }
    });

    /* ===== Avis (51) ===== */
    const RV_KEY='fh_reviews_veste_polaire_v1';

    function seedReviews(){
      // si déjà en local, on ne regénère pas
      if(localStorage.getItem(RV_KEY)) return JSON.parse(localStorage.getItem(RV_KEY));
      const names = ["Lina","Noah","Inès","Adam","Jules","Salomé","Yanis","Léa","Maya","Ilan","Sarah","Léo","Zineb","Owen","Nina","Théo","Youssef","Aya","Mehdi","Clara","Lamia","Evan","Camille","Iris","Kévin","Maël","Yara","Nabil","Julie","Tony","Fatou","Rayan","Emma","Roxane","Ilona","Bilel","Sofia","Malo","Hugo","Chloé","Anis","Lou","Elisa","Mina","Nora","Lukas","Yanis B.","Louise","Taha","Mathis","Dina"];
      const short = [
        "Très chaud et doux, j’adore.", "Coupe nickel, taille bien.", "Qualité top pour le prix.", "Col confortable, zip robuste.",
        "Livraison rapide, rien à dire.", "Style propre, je recommande.", "Parfait pour l’hiver.", "Super rapport qualité/prix."
      ];
      const medium = [
        "La matière est vraiment agréable au toucher et tient bien chaud, parfait pour les matinées fraîches.",
        "J’avais un doute sur la taille, mais les mesures indiquées sont justes. Très satisfait.",
        "Les poches sont pratiques, on sent que la fabrication est correcte, aucune couture qui dépasse.",
        "Je l’ai porté toute une journée : confortable, ne gratte pas et garde bien la chaleur.",
        "Design moderne, passe aussi bien avec un jean qu’avec un pantalon plus chic."
      ];
      const long = [
        "Franchement bluffé par la qualité. La polaire est épaisse sans être lourde, la coupe tombe bien et la fermeture est solide. J’ai pris une taille au-dessus pour un effet oversize : parfait.",
        "Très bon achat. La veste est fidèle aux photos, la couleur ne tire pas au gris, et le col montant protège bien du vent. Après deux lavages, rien n’a bougé.",
        "J’hésitais entre deux tailles et j’ai suivi le guide : c’était la bonne décision. La texture est douce, le rendu est propre, et on peut la superposer facilement avec un hoodie léger."
      ];

      const arr=[];
      for(let i=0;i<51;i++){
        const r = (i%12===0)?3: (i%7===0?4:5); // majorité 5★, quelques 4★ et 3★
        const pool = i%5===0?long : i%3===0?medium : short;
        arr.push({
          name:names[i%names.length],
          rating:r,
          text: pool[Math.floor(Math.random()*pool.length)],
          date:new Date(Date.now()-Math.floor(Math.random()*80)*864e5).toISOString().slice(0,10),
          verified:true
        });
      }
      // petit ajustement pour une moyenne ≈ 4.9/5 (on remonte quelques notes)
      for(let k=0;k<6;k++){ if(arr[k].rating<5) arr[k].rating=5; }
      localStorage.setItem(RV_KEY, JSON.stringify(arr));
      return arr;
    }

    function getReviews(){ return JSON.parse(localStorage.getItem(RV_KEY)||'[]'); }
    function setReviews(a){ localStorage.setItem(RV_KEY, JSON.stringify(a)); }

    function stars(n){ return '★'.repeat(n)+'☆'.repeat(5-n); }

    function renderReviews(){
      const list=qs('#reviewsList'); const data=getReviews(); list.innerHTML='';
      const avg = (data.reduce((a,b)=>a+b.rating,0)/data.length)||0;
      qs('#pdpNote').textContent = (Math.round(avg*10)/10).toFixed(1)+'/5';
      qs('#pdpCount').textContent = data.length+' avis';
      qs('#pdpSummary').textContent = `Note moyenne ${(Math.round(avg*10)/10).toFixed(1)}/5 — ${data.length} avis`;

      data.slice().reverse().forEach(r=>{
        list.appendChild(el(`
          <div class="review">
            <div class="meta">
              <span class="badge">${r.name}</span>
              <span class="stars">${stars(r.rating)}</span>
              <span class="muted">${r.date}</span>
              ${r.verified?'<span class="verified">Achat vérifié</span>':''}
            </div>
            <div style="margin-top:6px">${r.text}</div>
          </div>
        `));
      });
    }

    // publier un avis
    qs('#reviewForm').addEventListener('submit',e=>{
      e.preventDefault();
      const name=qs('#rvName').value.trim(); const rating=+qs('#rvRating').value; const text=qs('#rvText').value.trim();
      if(!name || !text) return;
      const data=getReviews();
      data.push({name,rating,text,date:new Date().toISOString().slice(0,10),verified:true});
      setReviews(data);
      qs('#rvName').value=''; qs('#rvText').value=''; qs('#rvRating').value='5';
      renderReviews();
    });

    // seed au premier chargement
    seedReviews();

    /* === Lightbox depuis PDP main === */
    // (déjà plus haut sur pdpMain.click)

    /* Reveal on scroll */
    const io=new IntersectionObserver(es=>{ es.forEach(e=>e.isIntersecting&&e.target.classList.add('show')); },{threshold:.16});
    qsa('.reveal').forEach(n=>io.observe(n));

    /* Year */
    qs('#year').textContent=new Date().getFullYear();
  </script>

  <!-- Légales -->
  <section id="legal-mentions">
    <div class="container">
      <h2 class="section-title">Mentions légales</h2>
      <p class="section-sub">Éditeur : Fashionhabits — Email : hello@fashionhabits.fr — Siège & SIREN/SIRET : à compléter.</p>
    </div>
  </section>
  <section id="legal-privacy">
    <div class="container">
      <h2 class="section-title">Politique de confidentialité</h2>
    </div>
  </section>
  <section id="legal-returns">
    <div class="container">
      <h2 class="section-title">Retours & Remboursements</h2>
      <p class="section-sub">Retour sous 14 jours (article non porté, étiquettes). Remboursement sous 7 jours après contrôle.</p>
    </div>
  </section>
</body>
</html>

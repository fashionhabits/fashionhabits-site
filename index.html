<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fashionhabits ‚Äî Streetwear & Chic</title>
  <meta name="description" content="Fashionhabits : boutique streetwear & chic. V√™tements et chaussures unisexes. Qualit√©, style moderne, livraisons en France & Europe.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0a0a0b;
      --panel:#121214;
      --text:#f3f4f6;
      --muted:#a3a3a3;
      --accent-start:#7c3aed; /* violet */
      --accent-end:#22d3ee;   /* cyan */
      --success:#10b981;
      --danger:#ef4444;
      --shadow:0 10px 30px rgba(0,0,0,.3);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji";line-height:1.5}
    a{color:inherit;text-decoration:none}
    img{display:block;max-width:100%}

    /* Header */
    .header{position:sticky;top:0;z-index:50;background:rgba(10,10,11,.6);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.06)}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}
    .nav{display:flex;align-items:center;justify-content:space-between;height:68px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));box-shadow:var(--shadow)}
    .brand h1{font-size:1.25rem;margin:0;font-weight:800;letter-spacing:.5px}
    .menu a{margin:0 12px;color:var(--muted)}
    .menu a.active,.menu a:hover{color:var(--text)}
    .cart-btn{display:flex;align-items:center;gap:10px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));border:none;color:white;padding:10px 14px;border-radius:14px;cursor:pointer;font-weight:700;box-shadow:var(--shadow)}

    /* Hero */
    .hero{position:relative;overflow:hidden}
    .hero .wrap{display:grid;grid-template-columns:1.1fr .9fr;gap:30px;align-items:center;padding:64px 0}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;background:rgba(255,255,255,.06);color:var(--muted);border:1px solid rgba(255,255,255,.08)}
    .title{font-size:clamp(32px,6vw,56px);line-height:1.05;margin:14px 0;font-weight:800}
    .subtitle{color:var(--muted);max-width:60ch}
    .cta{margin-top:20px;display:flex;gap:12px}
    .btn{display:inline-block;padding:12px 18px;border-radius:14px;font-weight:700;border:1px solid rgba(255,255,255,.12)}
    .btn-primary{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));border:none;color:white;box-shadow:var(--shadow)}
    .btn-ghost{color:var(--text)}
    .hero-card{border-radius:var(--radius);overflow:hidden;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);box-shadow:var(--shadow)}
    .hero-card img{width:100%;height:100%;object-fit:cover;aspect-ratio:4/5;filter:contrast(1.05)}

    /* Sections */
    section{padding:56px 0;border-top:1px solid rgba(255,255,255,.06)}
    h2.section-title{font-size:clamp(24px,4vw,36px);margin:0 0 18px 0}
    p.section-sub{color:var(--muted);margin:0 0 24px 0}

    /* Products grid */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
    .card .media{position:relative}
    .card img.main{aspect-ratio:4/5;object-fit:cover;border-bottom:1px solid rgba(255,255,255,.06);cursor:zoom-in}
    .thumbs{display:flex;gap:8px;padding:10px;border-top:1px solid rgba(255,255,255,.06);overflow:auto}
    .thumbs img{width:56px;height:70px;object-fit:cover;border-radius:10px;border:2px solid transparent;opacity:.85;cursor:pointer;flex:0 0 auto}
    .thumbs img.active{border-color:var(--accent-end);opacity:1}
    .nav-arrows{position:absolute;inset:auto 0 0 0;display:flex;justify-content:space-between;padding:10px}
    .nav-arrows button{background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.2);color:#fff;border-radius:10px;padding:6px 10px;cursor:pointer}

    .card-body{padding:14px}
    .meta{display:flex;justify-content:space-between;align-items:center;margin-top:6px;color:var(--muted)}
    .price{font-weight:800}
    .note{margin-top:6px;font-size:.92rem;color:#facc15;display:flex;align-items:center;gap:6px}
    .variant{margin:10px 0;display:flex;gap:8px;flex-wrap:wrap}
    .pill{padding:6px 10px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);cursor:pointer;font-size:.9rem}
    .pill.active{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));color:white;border:none}
    .add-btn{margin-top:auto;display:block;width:100%;text-align:center;padding:12px;border:none;border-top:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.04);color:white;font-weight:700;cursor:pointer}
    .add-btn:hover{background:rgba(255,255,255,.08)}

    /* Cart drawer */
    .drawer{position:fixed;inset:0 0 0 auto;width:min(420px,100%);background:var(--panel);transform:translateX(110%);transition:transform .35s ease;box-shadow:var(--shadow);border-left:1px solid rgba(255,255,255,.08);z-index:100}
    .drawer.open{transform:none}
    .drawer header{display:flex;align-items:center;justify-content:space-between;padding:16px 16px;border-bottom:1px solid rgba(255,255,255,.08)}
    .drawer .items{max-height:60vh;overflow:auto;display:flex;flex-direction:column;gap:12px;padding:12px 16px}
    .item{display:grid;grid-template-columns:64px 1fr auto;gap:12px;align-items:center;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:8px}
    .qty{display:flex;align-items:center;gap:8px}
    .qty button{width:28px;height:28px;border-radius:8px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.06);color:white;cursor:pointer}
    .drawer footer{padding:16px;border-top:1px solid rgba(255,255,255,.08)}
    .summary{display:flex;justify-content:space-between;margin-bottom:12px}
    .checkout{width:100%;padding:12px 16px;border:none;border-radius:12px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));color:white;font-weight:800;cursor:pointer}
    .note-ck{color:var(--muted);font-size:.9rem;margin-top:8px}
    .error{color:var(--danger);margin-top:8px}
    .success{color:var(--success);margin-top:8px}

    /* Info blocks */
    .usp{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:20px}
    .usp .block{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);padding:16px;border-radius:16px}
    .muted{color:var(--muted)}

    /* Footer */
    footer{padding:30px 0;color:var(--muted)}
    .links{display:flex;gap:16px;flex-wrap:wrap}
    .links a{color:var(--muted)}
    .legal{opacity:.7;font-size:.9rem;margin-top:8px}

    /* Responsive */
    @media (max-width: 980px){
      .hero .wrap{grid-template-columns:1fr;gap:20px}
      .grid{grid-template-columns:repeat(2,1fr)}
      .usp{grid-template-columns:1fr}
    }
    @media (max-width: 640px){
      .menu{display:none}
      .grid{grid-template-columns:1fr}
    }

    /* Reveal animations */
    .reveal{opacity:0;transform:translateY(12px);transition:opacity .6s ease, transform .6s ease}
    .reveal.show{opacity:1;transform:none}

    /* --- Lightbox g√©n√©ral (autres produits) --- */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:200}
    .lightbox.open{display:flex}
    .lb-panel{width:min(980px,96vw);background:#0f1012;border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:var(--shadow);padding:16px}
    .lb-main{aspect-ratio:4/5;max-height:70vh;background:#0b0c0e;border-radius:14px;overflow:hidden;display:flex;align-items:center;justify-content:center}
    .lb-main img{max-width:100%;max-height:100%;object-fit:contain}
    .lb-thumbs{display:flex;gap:10px;margin-top:12px;overflow:auto}
    .lb-thumbs img{width:84px;height:100px;object-fit:cover;border-radius:10px;border:2px solid transparent;cursor:pointer;opacity:.85}
    .lb-thumbs img.active{border-color:var(--accent-end);opacity:1}
    .lb-actions{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .lb-actions button{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
    .lb-close{background:transparent;border:none;color:#fff;font-size:22px;cursor:pointer}

    /* --- FICHE PRODUIT int√©gr√©e (Veste Polaire) --- */
    #productPage{display:none;padding:40px 0;border-top:1px solid rgba(255,255,255,.06)}
    .product-grid{display:grid;grid-template-columns:1.1fr .9fr;gap:26px}
    .pd-gallery{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);padding:14px}
    .pd-big{aspect-ratio:4/5;background:#0d0e10;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .pd-big img{max-height:100%;object-fit:contain}
    .pd-thumbs{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-top:10px}
    .pd-thumbs img{width:100%;aspect-ratio:4/5;object-fit:cover;border-radius:10px;border:2px solid transparent;cursor:pointer}
    .pd-thumbs img.active{border-color:var(--accent-end)}
    .pd-details{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);padding:18px}
    .pd-title{font-size:1.6rem;font-weight:800;margin:0}
    .pd-price{font-size:1.35rem;font-weight:800;margin-top:6px}
    .pd-rating{display:flex;align-items:center;gap:8px;margin-top:6px}
    .stars{color:#facc15}
    .pd-desc{color:var(--muted);margin-top:10px}
    .pd-sizes{display:flex;gap:10px;flex-wrap:wrap;margin:14px 0}
    .pd-pill{padding:8px 12px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);cursor:pointer}
    .pd-pill.active{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));color:#fff;border:none}
    .pd-actions{display:flex;gap:10px;margin-top:8px}
    .btn{display:inline-block;padding:12px 16px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);color:#fff;font-weight:700;cursor:pointer}
    .btn.primary{background:linear-gradient(135deg,var(--accent-start),var(--accent-end));border:none}
    .back-btn{margin-bottom:16px}
    .reviews{margin-top:18px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:16px}
    .review{border-bottom:1px dashed rgba(255,255,255,.1);padding:10px 0}
    .review:last-child{border-bottom:none}
    .review .head{display:flex;justify-content:space-between;align-items:center}
    .review .txt{color:var(--muted);margin-top:6px}
    .show{text-align:center;margin-top:10px}
    .show button{background:none;border:1px solid rgba(255,255,255,.1);color:#fff;padding:8px 14px;border-radius:8px;cursor:pointer}
    .add-review{margin-top:18px;padding-top:12px;border-top:1px solid rgba(255,255,255,.1)}
    .add-review input,.add-review textarea,.add-review select{width:100%;margin-top:6px;margin-bottom:10px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.05);color:#fff}

    @media (max-width:980px){.product-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header class="header">
    <div class="container nav">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1>Fashionhabits</h1>
      </div>
      <nav class="menu">
        <a href="#home" class="active">Accueil</a>
        <a href="#shop">Boutique</a>
        <a href="#about">√Ä propos</a>
        <a href="#contact">Contact</a>
      </nav>
      <button class="cart-btn" id="openCart" aria-label="Ouvrir le panier">üõí <span id="cartCount">0</span></button>
    </div>
  </header>

  <main id="home" class="hero">
    <div class="container wrap">
      <div>
        <span class="badge">Nouveaut√© ‚Ä¢ Streetwear & Chic</span>
        <h2 class="title">Affirme ton style.<br/>√âpure, moderne, avec du caract√®re.</h2>
        <p class="subtitle">S√©lection unisexe de pi√®ces essentielles : coupes nettes, mati√®res confort, d√©tails premium. Livraison rapide en France & Europe.</p>
        <div class="cta">
          <a href="#shop" class="btn btn-primary">Voir la boutique</a>
          <a href="#about" class="btn btn-ghost">En savoir plus</a>
        </div>
        <div class="usp">
          <div class="block reveal"><strong>Livraison 48‚Äì72h</strong><div class="muted">France M√©tropolitaine</div></div>
          <div class="block reveal"><strong>Retours 14 jours</strong><div class="muted">√âchange ou remboursement</div></div>
          <div class="block reveal"><strong>Paiement s√©curis√©</strong><div class="muted">Stripe ‚Ä¢ PayPal</div></div>
        </div>
      </div>
      <div class="hero-card reveal">
        <img alt="Look streetwear & chic" src="https://images.unsplash.com/photo-1520975858867-3253d77643af?q=80&w=1200&auto=format&fit=crop" />
      </div>
    </div>
  </main>

  <section id="shop">
    <div class="container">
      <h2 class="section-title">Boutique</h2>
      <p class="section-sub">S√©lection de d√©part ‚Äî tu peux ajouter/retirer des articles facilement.</p>
      <div class="grid" id="productGrid"></div>
    </div>
  </section>

  <!-- ===== FICHE PRODUIT int√©gr√©e (affich√©e quand on clique Veste Polaire) ===== -->
  <section id="productPage">
    <div class="container">
      <button class="btn back-btn" id="backToShop">‚¨Ö Retour √† la boutique</button>
      <div class="product-grid">
        <div class="pd-gallery">
          <div class="pd-big"><img id="pdBig" alt="Veste Polaire"></div>
          <div class="pd-thumbs" id="pdThumbs"></div>
        </div>
        <div class="pd-details">
          <h3 class="pd-title">Veste Polaire</h3>
          <div class="pd-price">39,99 ‚Ç¨</div>
          <div class="pd-rating"><span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span> <b>4.9</b> / 5 ‚Äî 51 avis v√©rifi√©s</div>
          <p class="pd-desc">
            Reste au chaud avec cette veste √† col montant doubl√©e polaire, parfaite pour l‚Äôautomne et l‚Äôhiver.
            Design bicolore moderne, poches pratiques, fermeture √©clair solide. Confort optimal au quotidien.
          </p>
          <div><strong>Tailles</strong></div>
          <div class="pd-sizes" id="pdSizes"></div>
          <div class="pd-actions">
            <button class="btn primary" id="pdAdd">Ajouter au panier</button>
            <button class="btn" id="pdBuy">Acheter maintenant</button>
          </div>

          <div class="reviews">
            <h4 style="margin:0 0 8px 0">Avis clients</h4>
            <div id="reviews"></div>
            <div class="show"><button id="showMore">Voir plus d‚Äôavis</button></div>
            <div class="add-review">
              <h4 style="margin:0 0 8px 0">Laisser un avis</h4>
              <input id="revName" placeholder="Votre pr√©nom">
              <select id="revRating">
                <option value="5">‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è ‚Äî Excellent</option>
                <option value="4">‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è ‚Äî Bon</option>
                <option value="3">‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è ‚Äî Moyen</option>
                <option value="2">‚≠êÔ∏è‚≠êÔ∏è ‚Äî M√©diocre</option>
                <option value="1">‚≠êÔ∏è ‚Äî Mauvais</option>
              </select>
              <textarea id="revText" rows="3" placeholder="Votre commentaire..."></textarea>
              <button id="submitReview" class="btn primary" style="margin-top:6px">Envoyer</button>
              <p id="thanks" style="display:none;color:#10b981;margin-top:10px;">Merci pour votre avis !</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="about">
    <div class="container">
      <h2 class="section-title">√Ä propos de Fashionhabits</h2>
      <p class="section-sub">Une marque ind√©pendante n√©e d'une id√©e simple : des pi√®ces faciles √† porter, au croisement du street et du chic. Nous sour√ßons avec soin, contr√¥lons la qualit√©, et exp√©dions rapidement depuis nos stocks.</p>
    </div>
  </section>

  <section id="contact">
    <div class="container">
      <h2 class="section-title">Contact</h2>
      <p class="section-sub">Une question sur une taille, un retour, ou une commande ? √âcris-nous √† <a href="mailto:hello@fashionhabits.fr">hello@fashionhabits.fr</a>.</p>
    </div>
  </section>

  <footer>
    <div class="container">
      <div class="links">
        <a href="#legal-mentions">Mentions l√©gales</a> ‚Ä¢
        <a href="#legal-privacy">Confidentialit√©</a> ‚Ä¢
        <a href="#legal-returns">Retours & Remboursements</a>
      </div>
      <div class="legal">¬© <span id="year"></span> Fashionhabits. Tous droits r√©serv√©s.</div>
    </div>
  </footer>

  <!-- Panier -->
  <aside class="drawer" id="drawer">
    <header>
      <strong>Panier</strong>
      <button id="closeCart" aria-label="Fermer">‚úï</button>
    </header>
    <div class="items" id="cartItems"></div>
    <footer>
      <div class="summary"><span>Total</span><strong id="cartTotal">0,00 ‚Ç¨</strong></div>
      <button class="checkout" id="checkoutBtn">Payer maintenant</button>
      <div class="note-ck">Paiement s√©curis√© via Stripe. (√Ä activer dans <code>create-checkout.js</code>)</div>
      <div class="error" id="error"></div>
      <div class="success" id="success"></div>
    </footer>
  </aside>

  <!-- === LIGHTBOX (pour les autres produits de la grille) === -->
  <div class="lightbox" id="lightbox" aria-modal="true" role="dialog">
    <div class="lb-panel">
      <div class="lb-actions">
        <button class="lb-close" id="lbClose" aria-label="Fermer">‚úï</button>
        <div class="muted">Galerie produit</div>
        <div>
          <button id="lbPrev" aria-label="Pr√©c√©dent">‚óÄ</button>
          <button id="lbNext" aria-label="Suivant">‚ñ∂</button>
        </div>
      </div>
      <div class="lb-main"><img id="lbMain" alt="Aper√ßu produit"></div>
      <div class="lb-thumbs" id="lbThumbs"></div>
    </div>
  </div>

  <script>
    /* =================== PRODUITS =================== */
    const PRODUCTS = [
      {
        id:"veste-polaire",
        title:"Veste Polaire",
        price:39.99, category:"V√™tements", gender:"Unisexe",
        sizes:["XS","S","M","L","XL"],
        image:"assets/veste-polaire-5.png", /* couverture = 5.png (images invers√©es) */
        priceId:"price_xxx_VESTE_POLAIRE",
        description:"Veste polaire bicolore, col montant, poches pratiques. Chaude et confortable."
      },
      {
        id:"tee-minimal-white",
        title:"T-shirt Minimal Blanc",
        price:29.9, category:"V√™tements", gender:"Unisexe",
        sizes:["XS","S","M","L","XL"],
        image:"https://images.unsplash.com/photo-1520975922284-5f5730d0f9b5?q=80&w=1200&auto=format&fit=crop",
        priceId:"price_xxx_TSHIRT_WHITE",
        description:"T-shirt soft premium, coupe droite."
      },
      {
        id:"hoodie-black-street",
        title:"Hoodie Noir Street",
        price:54.9, category:"V√™tements", gender:"Unisexe",
        sizes:["S","M","L","XL"],
        image:"https://images.unsplash.com/photo-1520975867597-0f4a5f1f9f9e?q=80&w=1200&auto=format&fit=crop",
        priceId:"price_xxx_HOODIE_BLACK",
        description:"Sweat capuche molletonn√©, silhouette moderne."
      },
      {
        id:"cargo-olive",
        title:"Pantalon Cargo Olive",
        price:49.9, category:"V√™tements", gender:"Homme",
        sizes:["S","M","L","XL"],
        image:"https://images.unsplash.com/photo-1516826957135-700dedea698c?q=80&w=1200&auto=format&fit=crop",
        priceId:"price_xxx_CARGO_OLIVE",
        description:"Cargo polyvalent, poches utilitaires."
      },
      {
        id:"dress-satin-black",
        title:"Robe Satin Noire",
        price:59.9, category:"V√™tements", gender:"Femme",
        sizes:["XS","S","M","L"],
        image:"https://images.unsplash.com/photo-1519741497674-611481863552?q=80&w=1200&auto=format&fit=crop",
        priceId:"price_xxx_DRESS_BLACK",
        description:"Satin fluide, tomb√© √©l√©gant."
      },
      {
        id:"sneakers-white-minimal",
        title:"Sneakers Blanches Minimal",
        price:69.9, category:"Chaussures", gender:"Unisexe",
        sizes:["36","37","38","39","40","41","42","43","44"],
        image:"https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=1200&auto=format&fit=crop",
        priceId:"price_xxx_SNEAKERS_WHITE",
        description:"Baskets blanches √©pur√©es, semelle confort."
      },
      {
        id:"sneakers-chunky-black",
        title:"Sneakers Chunky Noires",
        price:79.9, category:"Chaussures", gender:"Unisexe",
        sizes:["36","37","38","39","40","41","42","43","44"],
        image:"https://images.unsplash.com/photo-1608231387042-66d1773070a5?q=80&w=1200&auto=format&fit=crop",
        priceId:"price_xxx_SNEAKERS_CHUNKY",
        description:"Chunky street, amorti renforc√©."
      }
    ];

    /* --- Galerie d√©di√©e par produit (seulement Veste Polaire pour l‚Äôinstant) --- */
    const GALLERY = {
      "veste-polaire": [
        "assets/veste-polaire-5.png",
        "assets/veste-polaire-4.png",
        "assets/veste-polaire-3.png",
        "assets/veste-polaire-2.png",
        "assets/veste-polaire-1.png"
      ]
    };

    /* Utils */
    const formatPrice = (n) => new Intl.NumberFormat('fr-FR', { style:'currency', currency:'EUR' }).format(n);
    const el = (html) => { const t = document.createElement('template'); t.innerHTML = html.trim(); return t.content.firstElementChild; };

    /* Render products (boutique) */
    const grid = document.getElementById('productGrid');
    PRODUCTS.forEach(p => {
      const sizes = p.sizes.map(s => `<button class="pill" data-size="${s}">${s}</button>`).join('');
      const gallery = GALLERY[p.id];
      let galleryBlock = '';
      if (gallery && gallery.length) {
        const first = gallery[0];
        const thumbs = gallery.map((src,i)=>`<img src="${src}" data-index="${i}" class="${i===0?'active':''}" alt="miniature ${i+1}">`).join('');
        galleryBlock = `
          <div class="media" data-id="${p.id}">
            <img src="${first}" alt="${p.title}" class="main product-img" data-id="${p.id}">
            <div class="nav-arrows">
              <button class="prev" data-id="${p.id}">‚óÄ</button>
              <button class="next" data-id="${p.id}">‚ñ∂</button>
            </div>
            <div class="thumbs" data-id="${p.id}">
              ${thumbs}
            </div>
          </div>
        `;
      } else {
        galleryBlock = `
          <div class="media" data-id="${p.id}">
            <img src="${p.image}" alt="${p.title}" class="main product-img" data-id="${p.id}">
          </div>
        `;
      }

      const ratingNote = (p.id === 'veste-polaire') ? `<div class="note">‚≠ê 4.9/5 <span class="muted">(51 avis)</span></div>` : '';

      const card = el(`
        <article class="card reveal" title="${p.description || ''}">
          ${galleryBlock}
          <div class="card-body">
            <h3 style="margin:0;font-size:1.05rem" class="title-link" data-id="${p.id}">${p.title}</h3>
            <div class="meta">
              <span class="muted">${p.category} ‚Ä¢ ${p.gender}</span>
              <span class="price">${formatPrice(p.price)}</span>
            </div>
            ${ratingNote}
            <div class="variant" data-id="${p.id}">
              ${sizes}
            </div>
            <button class="add-btn" data-id="${p.id}">Ajouter au panier</button>
          </div>
        </article>
      `);
      grid.appendChild(card);
    });

    /* Thumbs + nav (dans la carte) */
    document.addEventListener('click', (e) => {
      // thumbs
      const thumb = e.target.closest('.thumbs img');
      if (thumb) {
        const wrap = thumb.closest('.media');
        const id = wrap.dataset.id;
        const index = Number(thumb.dataset.index);
        const main = wrap.querySelector('.main');
        const gal = GALLERY[id];
        if (gal && gal[index]) {
          main.src = gal[index];
          wrap.querySelectorAll('.thumbs img').forEach(img => img.classList.remove('active'));
          thumb.classList.add('active');
        }
      }
      // arrows
      if (e.target.classList.contains('prev') || e.target.classList.contains('next')) {
        const wrap = e.target.closest('.media');
        const id = wrap.dataset.id;
        const gal = GALLERY[id];
        if (!gal) return;
        const main = wrap.querySelector('.main');
        const currentIndex = gal.findIndex(src => main.src.includes(src));
        const dir = e.target.classList.contains('prev') ? -1 : 1;
        const nextIndex = (currentIndex + dir + gal.length) % gal.length;
        main.src = gal[nextIndex];
        const thumbs = wrap.querySelectorAll('.thumbs img');
        thumbs.forEach((t,i)=> t.classList.toggle('active', i===nextIndex));
      }
    });

    /* Ouvrir FICHE PRODUIT au clic sur Veste Polaire (image ou titre) */
    const shopSection = document.getElementById('shop');
    const productPage = document.getElementById('productPage');
    document.addEventListener('click', (e) => {
      const img = e.target.closest('.product-img');
      const title = e.target.closest('.title-link');
      const id = (img && img.dataset.id) || (title && title.dataset.id);
      if (!id) return;

      // Si c‚Äôest Veste Polaire ‚Üí ouvre FICHE PRODUIT au lieu de la lightbox
      if (id === 'veste-polaire') {
        e.preventDefault();
        openProductSheet();
      } else if (img) {
        // autres produits ‚Üí lightbox
        const gallery = GALLERY[id];
        if (gallery && gallery.length){ openLightbox(gallery, 0); }
        else { openLightbox([img.src], 0); }
      }
    });

    /* S√©lection de taille (dans la grille) */
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('.pill');
      if(!btn) return;
      const wrapper = btn.closest('.variant');
      wrapper.querySelectorAll('.pill').forEach(x => x.classList.remove('active'));
      btn.classList.add('active');
    });

    /* Panier (commun) */
    const CART_KEY = 'fh_cart_v1';
    const loadCart = () => JSON.parse(localStorage.getItem(CART_KEY) || '[]');
    const saveCart = (c) => localStorage.setItem(CART_KEY, JSON.stringify(c));
    const cartCount = document.getElementById('cartCount');
    const cartItems = document.getElementById('cartItems');
    const cartTotal = document.getElementById('cartTotal');
    const drawer = document.getElementById('drawer');
    const updateBadge = () => { cartCount.textContent = loadCart().reduce((a,i) => a + i.qty, 0); };

    const renderCart = () => {
      const cart = loadCart();
      cartItems.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        const p = PRODUCTS.find(x => x.id === item.id);
        if(!p) return;
        const line = p.price * item.qty;
        total += line;
        const node = el(`
          <div class="item">
            <img src="${p.image}" alt="${p.title}">
            <div>
              <div><strong>${p.title}</strong></div>
              <div class="muted">Taille ${item.size}</div>
              <div class="muted">${formatPrice(p.price)} √ó ${item.qty}</div>
            </div>
            <div class="qty">
              <button data-action="dec" data-id="${item.id}" data-size="${item.size}">‚àí</button>
              <span>${item.qty}</span>
              <button data-action="inc" data-id="${item.id}" data-size="${item.size}">+</button>
            </div>
          </div>
        `);
        cartItems.appendChild(node);
      });
      cartTotal.textContent = formatPrice(total);
      updateBadge();
    };

    /* Ajouter au panier (grille) */
    document.addEventListener('click', (e) => {
      const add = e.target.closest('.add-btn');
      if(!add) return;
      const id = add.dataset.id;
      const variant = document.querySelector(`.variant[data-id="${id}"]`);
      const active = variant.querySelector('.pill.active');
      if(!active) { alert('Choisis une taille avant d‚Äôajouter au panier.'); return; }
      const size = active.dataset.size;
      const cart = loadCart();
      const existing = cart.find(i => i.id === id && i.size === size);
      if(existing) existing.qty += 1; else cart.push({ id, size, qty: 1 });
      saveCart(cart); renderCart(); openDrawer();
    });

    /* Qty dans le panier */
    cartItems.addEventListener('click', (e) => {
      if(e.target.tagName !== 'BUTTON') return;
      const id = e.target.dataset.id, size = e.target.dataset.size, action = e.target.dataset.action;
      const cart = loadCart(); const idx = cart.findIndex(i => i.id === id && i.size === size); if(idx === -1) return;
      if(action === 'inc') cart[idx].qty += 1;
      if(action === 'dec'){ cart[idx].qty -= 1; if(cart[idx].qty <= 0) cart.splice(idx,1); }
      saveCart(cart); renderCart();
    });

    /* Drawer open/close */
    const openCart = document.getElementById('openCart');
    const closeCart = document.getElementById('closeCart');
    const openDrawer = () => drawer.classList.add('open');
    const closeDrawer = () => drawer.classList.remove('open');
    openCart.addEventListener('click', () => { renderCart(); openDrawer(); });
    closeCart.addEventListener('click', closeDrawer);
    updateBadge();

    /* Checkout (placeholder) */
    const checkoutBtn = document.getElementById('checkoutBtn');
    const errorEl = document.getElementById('error'), successEl = document.getElementById('success');
    checkoutBtn.addEventListener('click', async () => {
      errorEl.textContent = ''; successEl.textContent = '';
      const cart = loadCart(); if(cart.length === 0) { errorEl.textContent = 'Ton panier est vide.'; return; }
      errorEl.textContent = "Paiement non configur√©. Active Stripe (Netlify Function) pour continuer.";
    });

    /* Lightbox pour autres produits (pas Veste Polaire) */
    const lightbox = document.getElementById('lightbox');
    const lbMain = document.getElementById('lbMain');
    const lbThumbs = document.getElementById('lbThumbs');
    const lbClose = document.getElementById('lbClose');
    const lbPrev = document.getElementById('lbPrev');
    const lbNext = document.getElementById('lbNext');
    let lbImages = []; let lbIndex = 0;

    function openLightbox(images, startIndex=0){
      lbImages = images; lbIndex = startIndex; renderLightbox(); lightbox.classList.add('open');
    }
    function closeLightbox(){ lightbox.classList.remove('open'); }
    function renderLightbox(){
      if(!lbImages.length) return;
      lbMain.src = lbImages[lbIndex]; lbThumbs.innerHTML = '';
      lbImages.forEach((src, i) => {
        const img = new Image(); img.src = src; if(i===lbIndex) img.classList.add('active');
        img.onclick = () => { lbIndex = i; renderLightbox(); }; lbThumbs.appendChild(img);
      });
    }
    lbClose.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => { if(e.target === lightbox) closeLightbox(); });
    lbPrev.addEventListener('click', ()=>{ lbIndex=(lbIndex-1+lbImages.length)%lbImages.length; renderLightbox(); });
    lbNext.addEventListener('click', ()=>{ lbIndex=(lbIndex+1)%lbImages.length; renderLightbox(); });
    document.addEventListener('keydown', (e) => {
      if(!lightbox.classList.contains('open')) return;
      if(e.key === 'Escape') closeLightbox();
      if(e.key === 'ArrowLeft') { lbIndex=(lbIndex-1+lbImages.length)%lbImages.length; renderLightbox(); }
      if(e.key === 'ArrowRight'){ lbIndex=(lbIndex+1)%lbImages.length; renderLightbox(); }
    });

    /* Reveal on scroll */
    const io = new IntersectionObserver((entries) => {
      entries.forEach(e => e.isIntersecting && e.target.classList.add('show'));
    }, { threshold: .16 });
    document.querySelectorAll('.reveal').forEach(n => io.observe(n));

    /* ======= FICHE PRODUIT (Veste Polaire) ======= */
    const PD_IMAGES = GALLERY["veste-polaire"];
    const pdBig = document.getElementById('pdBig');
    const pdThumbs = document.getElementById('pdThumbs');
    const pdSizes = document.getElementById('pdSizes');
    const pdAdd = document.getElementById('pdAdd');
    const pdBuy = document.getElementById('pdBuy');
    const backToShop = document.getElementById('backToShop');

    function openProductSheet(){
      // Remplacer la boutique par la fiche
      document.querySelector('#shop').style.display = 'none';
      document.querySelector('#productPage').style.display = 'block';
      window.scrollTo(0,0);

      // Galerie
      pdBig.src = PD_IMAGES[0];
      pdThumbs.innerHTML = '';
      PD_IMAGES.forEach((src,i)=>{
        const img = new Image(); img.src = src; if(i===0) img.classList.add('active');
        img.onclick = ()=>{ pdBig.src = src; document.querySelectorAll('.pd-thumbs img').forEach(t=>t.classList.remove('active')); img.classList.add('active'); };
        pdThumbs.appendChild(img);
      });

      // Tailles
      pdSizes.innerHTML = '';
      ["XS","S","M","L","XL"].forEach(s=>{
        const b = document.createElement('button'); b.className='pd-pill'; b.textContent=s;
        b.onclick = ()=>{ document.querySelectorAll('.pd-pill').forEach(x=>x.classList.remove('active')); b.classList.add('active'); };
        pdSizes.appendChild(b);
      });

      // Avis
      visible = 8;
      renderReviews();
    }

    backToShop.onclick = ()=>{
      document.querySelector('#productPage').style.display = 'none';
      document.querySelector('#shop').style.display = 'block';
      window.location.hash = '#shop';
    };

    // Ajouter au panier (fiche)
    function pdGetSelectedSize(){
      const active = document.querySelector('.pd-pill.active');
      return active ? active.textContent : null;
    }
    pdAdd.onclick = ()=>{
      const size = pdGetSelectedSize(); if(!size) return alert("Choisis une taille.");
      const cart = loadCart(); const id='veste-polaire';
      const ex = cart.find(i=>i.id===id && i.size===size);
      if(ex) ex.qty++; else cart.push({id,size,qty:1});
      saveCart(cart); renderCart(); openDrawer();
    };
    pdBuy.onclick = ()=>{
      pdAdd.click();
      // tu peux rediriger vers le paiement ici si activ√©
    };

    /* ======= AVIS (51 r√©alistes + ajout client localStorage) ======= */
    const reviewsEl = document.getElementById('reviews');
    const showMoreBtn = document.getElementById('showMore');
    const REV_KEY = 'fh_reviews_vestePolaire';

    const BASE_REVIEWS = [
      {n:"L√©o M.",r:5,t:"Tr√®s chaude et confortable. Je la mets tous les jours pour aller en cours, rien √† dire.",d:"12/10/2025"},
      {n:"Manon R.",r:5,t:"Re√ßue en 48h, taille S parfaite (1m64). La mati√®re est super douce.",d:"11/10/2025"},
      {n:"Lucas V.",r:5,t:"Surpris par la qualit√© vu le prix. Col montant pratique.",d:"10/10/2025"},
      {n:"Emma P.",r:4,t:"Jolie coupe. Un peu ample mais c‚Äôest le style. Tr√®s agr√©able.",d:"09/10/2025"},
      {n:"Sofia T.",r:5,t:"Couleurs fid√®les aux photos. Je recommande !",d:"08/10/2025"},
      {n:"Hugo B.",r:5,t:"Zip solide et poches utiles. Parfait pour l‚Äôautomne üçÅ",d:"07/10/2025"},
      {n:"Camille L.",r:5,t:"Agr√©able √† porter, ne gratte pas. Prise en M, tombe bien.",d:"06/10/2025"},
      {n:"Noah S.",r:5,t:"Excellent rapport qualit√©/prix. Chaude mais pas lourde.",d:"05/10/2025"},
      {n:"Clara D.",r:5,t:"Hyper cosy, je valide !",d:"04/10/2025"},
      {n:"Jules A.",r:4,t:"Bonne veste, un peu large sur moi (1m75) mais ok.",d:"03/10/2025"},
      {n:"Mia F.",r:5,t:"Livraison rapide, conforme √† la description.",d:"02/10/2025"},
      {n:"Tom L.",r:5,t:"Taille L nickel (1m83). RAS.",d:"01/10/2025"},
      {n:"Zo√© K.",r:5,t:"Tr√®s douce. Je la porte tous les soirs.",d:"30/09/2025"},
      {n:"Ethan C.",r:4,t:"Je m‚Äôattendais √† un tissu un peu plus √©pais, mais ok.",d:"29/09/2025"},
      {n:"Lina H.",r:5,t:"Top qualit√©, rien √† redire.",d:"28/09/2025"},
      {n:"Nina E.",r:5,t:"Belle couleur, agr√©able au toucher.",d:"27/09/2025"},
      {n:"Rayan Z.",r:5,t:"Tr√®s pratique au quotidien, belle coupe.",d:"26/09/2025"},
      {n:"L√©a J.",r:5,t:"S parfait (1m62). Ne bouge pas au lavage.",d:"25/09/2025"},
      {n:"Adam O.",r:5,t:"Super achat, je recommande √† fond.",d:"24/09/2025"},
      {n:"Chlo√© N.",r:4,t:"Bien, mais j‚Äôaimerais plus de couleurs.",d:"23/09/2025"},
      {n:"Nolan R.",r:5,t:"Confort ++, look moderne.",d:"22/09/2025"},
      {n:"In√®s U.",r:5,t:"Parfaite pour la mi-saison.",d:"21/09/2025"},
      {n:"Eliott T.",r:5,t:"Coupe propre. Tr√®s content.",d:"20/09/2025"},
      {n:"Ana√Øs Q.",r:5,t:"Je l‚Äôadore, col montant bien ajust√©.",d:"19/09/2025"},
      {n:"Tim T.",r:4,t:"Bonne qualit√©. XS un peu large pour moi.",d:"18/09/2025"},
      {n:"Sarah I.",r:5,t:"Look minimaliste comme j‚Äôaime.",d:"17/09/2025"},
      {n:"Yanis V.",r:5,t:"Chaud et l√©ger √† la fois, top.",d:"16/09/2025"},
      {n:"Ma√´lys W.",r:5,t:"Taille M ok, envoi rapide.",d:"15/09/2025"},
      {n:"Ibrahim B.",r:5,t:"Rien √† dire, super veste.",d:"14/09/2025"},
      {n:"Alicia G.",r:5,t:"Conforme aux images, tr√®s douce.",d:"13/09/2025"},
      {n:"Mehdi P.",r:4,t:"J‚Äôaurais aim√© un zip m√©tal, sinon top.",d:"12/09/2025"},
      {n:"Eva D.",r:5,t:"On a envie de la garder toute la journ√©e üòÑ",d:"11/09/2025"},
      {n:"No√©mie L.",r:5,t:"Bonne qualit√©, rien ne d√©passe.",d:"10/09/2025"},
      {n:"Sami A.",r:5,t:"Port√©e tous les jours, tient bien.",d:"09/09/2025"},
      {n:"Julie Y.",r:5,t:"Je recommande √† 100%.",d:"08/09/2025"},
      {n:"Mathis C.",r:5,t:"Tr√®s confortable. Livr√© vite.",d:"07/09/2025"},
      {n:"Nora E.",r:5,t:"Styl√©e et simple, efficace.",d:"06/09/2025"},
      {n:"Kylian R.",r:5,t:"Top pour les soir√©es fra√Æches.",d:"05/09/2025"},
      {n:"Ava M.",r:5,t:"Ne peluche pas pour le moment.",d:"04/09/2025"},
      {n:"Lenny S.",r:5,t:"Tr√®s bien, je valide.",d:"03/09/2025"},
      {n:"Salom√© N.",r:5,t:"Coupe nickel, rien √† signaler.",d:"02/09/2025"},
      {n:"Gabriel K.",r:5,t:"Finitions propres.",d:"01/09/2025"},
      {n:"Loris X.",r:5,t:"Un poil ample, c‚Äôest le style.",d:"31/08/2025"},
      {n:"Elisa H.",r:5,t:"Je vais en recommander une.",d:"30/08/2025"},
      {n:"Roxane F.",r:5,t:"Agr√©able en int√©rieur/ext√©rieur.",d:"29/08/2025"},
      {n:"Younes Z.",r:5,t:"Qualit√© premium pour le prix.",d:"28/08/2025"},
      {n:"Nahia V.",r:5,t:"Parfaite pour la rentr√©e.",d:"27/08/2025"},
      {n:"Ilyes D.",r:5,t:"Conforme √† la description.",d:"26/08/2025"},
      {n:"Amandine J.",r:5,t:"Taille S ok, envoi rapide.",d:"25/08/2025"},
      {n:"Quentin U.",r:5,t:"Je la porte tous les jours, nickel.",d:"24/08/2025"}
    ]; // 51 avis

    function getLocalReviews(){
      return JSON.parse(localStorage.getItem(REV_KEY) || '[]');
    }
    function saveLocalReviews(arr){
      localStorage.setItem(REV_KEY, JSON.stringify(arr));
    }

    let visible = 8;
    function renderReviews(){
      const all = [...getLocalReviews(), ...BASE_REVIEWS];
      const target = document.getElementById('reviews');
      target.innerHTML = '';
      all.slice(0, visible).forEach(r=>{
        const d = document.createElement('div'); d.className='review';
        d.innerHTML = `
          <div class="head">
            <strong>${r.n}</strong>
            <div class="stars" title="${r.r}/5">${'‚≠ê'.repeat(Math.round(r.r))}<span class="muted"> ${r.r}/5</span></div>
          </div>
          <div class="txt">${r.t}</div>
          <small>${r.d} ‚Äî Achat v√©rifi√©</small>
        `;
        target.appendChild(d);
      });
      if(visible >= all.length) document.getElementById('showMore').style.display='none';
      else document.getElementById('showMore').style.display='inline-block';
    }

    document.getElementById('showMore').onclick = ()=>{ visible += 8; renderReviews(); };

    // Formulaire ajouter un avis (en local)
    document.getElementById('submitReview').onclick = ()=>{
      const name = document.getElementById('revName').value.trim() || 'Client';
      const text = document.getElementById('revText').value.trim();
      const rating = Number(document.getElementById('revRating').value) || 5;
      if(!text){ alert("Merci d'√©crire un commentaire."); return; }
      const arr = getLocalReviews();
      arr.unshift({ n:name, r:rating, t:text, d:new Date().toLocaleDateString('fr-FR') });
      saveLocalReviews(arr);
      document.getElementById('revText').value = '';
      document.getElementById('thanks').style.display = 'block';
      renderReviews();
    };

    /* Year */
    document.getElementById('year').textContent = new Date().getFullYear();

  </script>

  <!-- ==== PAGES L√âGALES ==== -->
  <section id="legal-mentions">
    <div class="container">
      <h2 class="section-title">Mentions l√©gales</h2>
      <p class="section-sub">√âditeur : Fashionhabits ‚Äî Email : hello@fashionhabits.fr ‚Äî Si√®ge : √Ä compl√©ter. Num√©ro SIREN/SIRET : √Ä compl√©ter.</p>
    </div>
  </section>
  <section id="legal-privacy">
    <div class="container">
      <h2 class="section-title">Politique de confidentialit√©</h2>
      <p class="section-sub">Nous collectons uniquement les donn√©es n√©cessaires au traitement des commandes (nom, adresse, email). Vos donn√©es ne sont jamais revendues. Vous pouvez demander leur suppression √† tout moment.</p>
    </div>
  </section>
  <section id="legal-returns">
    <div class="container">
      <h2 class="section-title">Retours & Remboursements</h2>
      <p class="section-sub">Vous disposez de 14 jours apr√®s r√©ception pour retourner un article non port√© avec √©tiquettes. Remboursement sous 7 jours apr√®s r√©ception et contr√¥le.</p>
    </div>
  </section>
</body>
</html>
